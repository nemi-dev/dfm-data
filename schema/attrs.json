{
  "$schema": "http://json-schema.org/schema",
  "definitions": {
    "when_combined_attrs": {
      "allOf": [
        { "$ref": "./mixed-attrs.json" },
        { 
          "properties": {
            "when" : {
              "type": "string",
              "description": "(branch, exclusive에서) 이 효과가 추가될 조건"
            }
          }
        }
      ]
    }
  },
  "allOf": [
    {
      "$ref": "./mixed-attrs.json"
    },
    {
    "required": ["name", "itype", "rarity", "level"],
      "properties": {
        "who": {
          "type": "string",
          "description": "이 아이템을 쓸 수 있는 직업"
        },
        "branch" : {
          "type" : "array",
          "description": "특정 조건에만 적용되는 효과",
          "items" : { "$ref": "#/definitions/when_combined_attrs" }
        },
        "gives" : { "description": "모든 파티원에게 적용되는 효과", "$ref": "#/definitions/when_combined_attrs" },
        "exclusive" : {
          "type" : "array",
          "description": "이 중에서 동시에 하나의 효과만 적용된다.",
          "items" : {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "브랜치 옵션 이름"
              },
              "label": {
                "type": "string",
                "description": "앱에 표시될 설명"
              },
              "children": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/when_combined_attrs"
                }
              }
            },
            "required": ["name", "label", "children"]
          }
        }
      }
    }
  ]
}
